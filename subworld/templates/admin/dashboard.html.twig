{% extends 'base.html.twig' %}

{% block title %}Dashboard{% endblock %}

{% block body %}
    <h2>Bienvenue, {{ app.user.username }} ðŸŽ‰</h2>
    <p>Votre tableau de bord</p>

    <h3>Mes derniÃ¨res publications</h3>
    <div id="posts"></div>

    <script>
        async function fetchUserPosts() {
            const token = localStorage.getItem('token');
            const response = await fetch('/api/posts/user', {
                headers: { 'Authorization': 'Bearer ' + token }
            });

            const posts = await response.json();
            let html = '';
            posts.forEach(post => {
                html += `<div class="card p-3"><h5>${post.title}</h5><p>${post.content}</p></div>`;
            });

            document.getElementById('posts').innerHTML = html;
        }
        fetchUserPosts();
    </script>
{% endblock %}
